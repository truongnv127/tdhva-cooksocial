{"ast":null,"code":"import { assertTokenProviderConfig } from '@aws-amplify/core/internals/utils';\nimport { getAuthStorageKeys } from '../tokenProvider/TokenStore.mjs';\nimport { OAuthStorageKeys } from './types.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nconst V5_HOSTED_UI_KEY = 'amplify-signin-with-hostedUI';\nconst name = 'CognitoIdentityServiceProvider';\nclass DefaultOAuthStore {\n  constructor(keyValueStorage) {\n    this.keyValueStorage = keyValueStorage;\n  }\n  async clearOAuthInflightData() {\n    assertTokenProviderConfig(this.cognitoConfig);\n    const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n    await Promise.all([this.keyValueStorage.removeItem(authKeys.inflightOAuth), this.keyValueStorage.removeItem(authKeys.oauthPKCE), this.keyValueStorage.removeItem(authKeys.oauthState)]);\n  }\n  async clearOAuthData() {\n    assertTokenProviderConfig(this.cognitoConfig);\n    const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n    await this.clearOAuthInflightData();\n    await this.keyValueStorage.removeItem(V5_HOSTED_UI_KEY); // remove in case a customer migrated an App from v5 to v6\n    return this.keyValueStorage.removeItem(authKeys.oauthSignIn);\n  }\n  loadOAuthState() {\n    assertTokenProviderConfig(this.cognitoConfig);\n    const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n    return this.keyValueStorage.getItem(authKeys.oauthState);\n  }\n  storeOAuthState(state) {\n    assertTokenProviderConfig(this.cognitoConfig);\n    const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n    return this.keyValueStorage.setItem(authKeys.oauthState, state);\n  }\n  loadPKCE() {\n    assertTokenProviderConfig(this.cognitoConfig);\n    const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n    return this.keyValueStorage.getItem(authKeys.oauthPKCE);\n  }\n  storePKCE(pkce) {\n    assertTokenProviderConfig(this.cognitoConfig);\n    const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n    return this.keyValueStorage.setItem(authKeys.oauthPKCE, pkce);\n  }\n  setAuthConfig(authConfigParam) {\n    this.cognitoConfig = authConfigParam;\n  }\n  async loadOAuthInFlight() {\n    assertTokenProviderConfig(this.cognitoConfig);\n    const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n    return (await this.keyValueStorage.getItem(authKeys.inflightOAuth)) === 'true';\n  }\n  async storeOAuthInFlight(inflight) {\n    assertTokenProviderConfig(this.cognitoConfig);\n    const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n    await this.keyValueStorage.setItem(authKeys.inflightOAuth, \"\".concat(inflight));\n  }\n  async loadOAuthSignIn() {\n    var _await$this$keyValueS, _await$this$keyValueS2;\n    assertTokenProviderConfig(this.cognitoConfig);\n    const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n    const isLegacyHostedUISignIn = await this.keyValueStorage.getItem(V5_HOSTED_UI_KEY);\n    const [isOAuthSignIn, preferPrivateSession] = (_await$this$keyValueS = (_await$this$keyValueS2 = await this.keyValueStorage.getItem(authKeys.oauthSignIn)) === null || _await$this$keyValueS2 === void 0 ? void 0 : _await$this$keyValueS2.split(',')) !== null && _await$this$keyValueS !== void 0 ? _await$this$keyValueS : [];\n    return {\n      isOAuthSignIn: isOAuthSignIn === 'true' || isLegacyHostedUISignIn === 'true',\n      preferPrivateSession: preferPrivateSession === 'true'\n    };\n  }\n  async storeOAuthSignIn(oauthSignIn) {\n    let preferPrivateSession = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    assertTokenProviderConfig(this.cognitoConfig);\n    const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n    await this.keyValueStorage.setItem(authKeys.oauthSignIn, \"\".concat(oauthSignIn, \",\").concat(preferPrivateSession));\n  }\n}\nconst createKeysForAuthStorage = (provider, identifier) => {\n  return getAuthStorageKeys(OAuthStorageKeys)(provider, identifier);\n};\nexport { DefaultOAuthStore };","map":{"version":3,"names":["V5_HOSTED_UI_KEY","name","DefaultOAuthStore","constructor","keyValueStorage","clearOAuthInflightData","assertTokenProviderConfig","cognitoConfig","authKeys","createKeysForAuthStorage","userPoolClientId","Promise","all","removeItem","inflightOAuth","oauthPKCE","oauthState","clearOAuthData","oauthSignIn","loadOAuthState","getItem","storeOAuthState","state","setItem","loadPKCE","storePKCE","pkce","setAuthConfig","authConfigParam","loadOAuthInFlight","storeOAuthInFlight","inflight","concat","loadOAuthSignIn","_await$this$keyValueS","_await$this$keyValueS2","isLegacyHostedUISignIn","isOAuthSignIn","preferPrivateSession","split","storeOAuthSignIn","arguments","length","undefined","provider","identifier","getAuthStorageKeys","OAuthStorageKeys"],"sources":["/home/truongnvops/Documents/Project_AWS/tdhva-cooksocial/frontend/node_modules/@aws-amplify/auth/src/providers/cognito/utils/signInWithRedirectStore.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { assertTokenProviderConfig } from '@aws-amplify/core/internals/utils';\nimport { getAuthStorageKeys } from '../tokenProvider/TokenStore';\nimport { OAuthStorageKeys } from './types';\nconst V5_HOSTED_UI_KEY = 'amplify-signin-with-hostedUI';\nconst name = 'CognitoIdentityServiceProvider';\nexport class DefaultOAuthStore {\n    constructor(keyValueStorage) {\n        this.keyValueStorage = keyValueStorage;\n    }\n    async clearOAuthInflightData() {\n        assertTokenProviderConfig(this.cognitoConfig);\n        const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n        await Promise.all([\n            this.keyValueStorage.removeItem(authKeys.inflightOAuth),\n            this.keyValueStorage.removeItem(authKeys.oauthPKCE),\n            this.keyValueStorage.removeItem(authKeys.oauthState),\n        ]);\n    }\n    async clearOAuthData() {\n        assertTokenProviderConfig(this.cognitoConfig);\n        const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n        await this.clearOAuthInflightData();\n        await this.keyValueStorage.removeItem(V5_HOSTED_UI_KEY); // remove in case a customer migrated an App from v5 to v6\n        return this.keyValueStorage.removeItem(authKeys.oauthSignIn);\n    }\n    loadOAuthState() {\n        assertTokenProviderConfig(this.cognitoConfig);\n        const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n        return this.keyValueStorage.getItem(authKeys.oauthState);\n    }\n    storeOAuthState(state) {\n        assertTokenProviderConfig(this.cognitoConfig);\n        const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n        return this.keyValueStorage.setItem(authKeys.oauthState, state);\n    }\n    loadPKCE() {\n        assertTokenProviderConfig(this.cognitoConfig);\n        const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n        return this.keyValueStorage.getItem(authKeys.oauthPKCE);\n    }\n    storePKCE(pkce) {\n        assertTokenProviderConfig(this.cognitoConfig);\n        const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n        return this.keyValueStorage.setItem(authKeys.oauthPKCE, pkce);\n    }\n    setAuthConfig(authConfigParam) {\n        this.cognitoConfig = authConfigParam;\n    }\n    async loadOAuthInFlight() {\n        assertTokenProviderConfig(this.cognitoConfig);\n        const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n        return ((await this.keyValueStorage.getItem(authKeys.inflightOAuth)) === 'true');\n    }\n    async storeOAuthInFlight(inflight) {\n        assertTokenProviderConfig(this.cognitoConfig);\n        const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n        await this.keyValueStorage.setItem(authKeys.inflightOAuth, `${inflight}`);\n    }\n    async loadOAuthSignIn() {\n        assertTokenProviderConfig(this.cognitoConfig);\n        const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n        const isLegacyHostedUISignIn = await this.keyValueStorage.getItem(V5_HOSTED_UI_KEY);\n        const [isOAuthSignIn, preferPrivateSession] = (await this.keyValueStorage.getItem(authKeys.oauthSignIn))?.split(',') ??\n            [];\n        return {\n            isOAuthSignIn: isOAuthSignIn === 'true' || isLegacyHostedUISignIn === 'true',\n            preferPrivateSession: preferPrivateSession === 'true',\n        };\n    }\n    async storeOAuthSignIn(oauthSignIn, preferPrivateSession = false) {\n        assertTokenProviderConfig(this.cognitoConfig);\n        const authKeys = createKeysForAuthStorage(name, this.cognitoConfig.userPoolClientId);\n        await this.keyValueStorage.setItem(authKeys.oauthSignIn, `${oauthSignIn},${preferPrivateSession}`);\n    }\n}\nconst createKeysForAuthStorage = (provider, identifier) => {\n    return getAuthStorageKeys(OAuthStorageKeys)(provider, identifier);\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}